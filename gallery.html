<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–∞–ª–µ—Ä–µ—è —Ä–∞–±–æ—Ç - –ö–æ–≥—Ç–∏–∫</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary-blue: #87CEEB;
            --primary-pink: #FFB6C1;
            --primary-white: #FFFFFF;
            --gradient: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-pink) 100%);
            --text-dark: #333;
            --text-light: #666;
            --shadow: 0 10px 30px rgba(135, 206, 235, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--gradient);
            color: var(--text-dark);
            padding: 10px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .header h1 {
            font-size: 26px;
            margin-bottom: 8px;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .admin-header {
            display: none;
            background: rgba(255,182,193,0.9);
            color: var(--text-dark);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 2px solid var(--primary-pink);
        }

        .admin-controls {
            display: none;
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border: 2px solid var(--primary-blue);
        }

        .add-work-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 auto 15px auto;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(135, 206, 235, 0.4);
        }

        .add-work-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(135, 206, 235, 0.5);
        }

        .filters {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            padding: 0 10px;
        }

        .filter-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-btn.active {
            background: var(--primary-white);
            color: var(--primary-blue);
            border-color: var(--primary-white);
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255,255,255,0.3);
        }

        .filter-btn:hover:not(.active) {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            border-color: rgba(255,255,255,0.5);
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .work-card {
            background: var(--primary-white);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            border: 2px solid transparent;
        }

        .work-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(135, 206, 235, 0.4);
            border-color: var(--primary-blue);
        }

        .work-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .work-card:hover .work-image {
            transform: scale(1.1);
        }

        .work-info {
            padding: 18px;
        }

        .work-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            line-height: 1.3;
            color: var(--text-dark);
        }

        .work-description {
            color: var(--text-light);
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .work-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: var(--text-light);
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 5px;
        }

        .work-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }

        .tag {
            background: var(--gradient);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(135, 206, 235, 0.3);
        }

        .work-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            border-top: 1px solid #f0f0f0;
            padding-top: 12px;
        }

        .price {
            font-weight: bold;
            color: var(--primary-blue);
            font-size: 14px;
        }

        .views {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-light);
        }

        .admin-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary-pink);
            color: white;
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
        }

        .delete-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .delete-btn:hover {
            background: #ff3742;
            transform: scale(1.1);
        }

        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            color: white;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty {
            text-align: center;
            color: white;
            padding: 50px 20px;
        }

        .empty-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
        }

        .modal-content {
            position: relative;
            background: white;
            margin: 3% auto;
            padding: 25px;
            width: 90%;
            max-width: 600px;
            border-radius: 20px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            cursor: pointer;
            color: var(--text-light);
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #f5f5f5;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: var(--primary-pink);
            color: white;
            transform: scale(1.1);
        }

        .modal-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
            box-shadow: 0 5px 15px rgba(135, 206, 235, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(135, 206, 235, 0.5);
        }

        .btn-secondary {
            background: #6c757d;
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.4);
        }

        .btn-secondary:hover {
            background: #5a6268;
            box-shadow: 0 8px 25px rgba(108, 117, 125, 0.5);
        }

        .hashtags-input {
            background: #f8f9fa;
            border: 1px dashed var(--primary-blue);
            padding: 10px;
            border-radius: 8px;
            font-size: 12px;
            color: var(--text-light);
        }

        @media (max-width: 768px) {
            body {
                padding: 8px;
            }

            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 15px;
            }

            .header {
                padding: 16px;
            }

            .header h1 {
                font-size: 22px;
            }

            .work-image {
                height: 200px;
            }

            .filters {
                gap: 6px;
            }

            .filter-btn {
                padding: 8px 12px;
                font-size: 12px;
            }

            .modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .gallery {
                grid-template-columns: 1fr;
            }

            .filters {
                justify-content: flex-start;
                overflow-x: auto;
                padding: 0 10px;
            }
        }
    </style>
</head>
<body>
    <div class="admin-header" id="adminHeader">
        <h2>üîß –†–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
        <p>–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —Ä–∞–±–æ—Ç—ã</p>
    </div>

    <div class="header">
        <h1>üñºÔ∏è –ì–∞–ª–µ—Ä–µ—è —Ä–∞–±–æ—Ç</h1>
        <p>–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è ¬´–ö–æ–≥—Ç–∏–∫¬ª ‚Ä¢ –ú–µ–±–µ–ª—å –¥–ª—è –ø–∏—Ç–æ–º—Ü–µ–≤ —Å 2019 –≥–æ–¥–∞</p>
    </div>

    <div class="admin-controls" id="adminControls">
        <button class="add-work-btn" onclick="openAddWorkModal()">
            <span>‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É
        </button>
    </div>

    <div class="filters" id="filters">
        <div class="filter-btn active" data-filter="all">üîç –í—Å–µ —Ä–∞–±–æ—Ç—ã</div>
        <!-- –§–∏–ª—å—Ç—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    </div>

    <div id="loading" class="loading">
        <div class="spinner"></div>
        <div>–ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—à–∏ —Ä–∞–±–æ—Ç—ã...</div>
    </div>

    <div id="gallery" class="gallery" style="display: none;"></div>

    <div id="empty" class="empty" style="display: none;">
        <div class="empty-icon">üì≠</div>
        <h3>–ù–µ—Ç —Ä–∞–±–æ—Ç –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Ñ–∏–ª—å—Ç—Ä</p>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–∞–±–æ—Ç—ã -->
    <div id="viewModal" class="modal">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal('viewModal')">&times;</div>
            <img id="modalImage" class="modal-image" alt="">
            <h3 id="modalTitle"></h3>
            <p id="modalDescription"></p>
            <div id="modalTags" class="work-tags"></div>
            <div id="modalSpecs"></div>
            <button class="btn" onclick="orderWork()" style="width: 100%; margin-top: 20px;">
                üìû –ó–∞–∫–∞–∑–∞—Ç—å —ç—Ç—É —Ä–∞–±–æ—Ç—É
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã -->
    <div id="addModal" class="modal">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal('addModal')">&times;</div>
            <h3 style="margin-bottom: 20px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ä–∞–±–æ—Ç—É</h3>

            <form id="addWorkForm">
                <div class="form-group">
                    <label>üñºÔ∏è URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
                    <input type="url" id="imageUrl" required placeholder="https://example.com/image.jpg">
                </div>

                <div class="form-group">
                    <label>üìù –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–∞:</label>
                    <input type="text" id="workTitle" required placeholder="–ö–æ–º–ø–ª–µ–∫—Å '–ù–∞–∑–≤–∞–Ω–∏–µ'">
                </div>

                <div class="form-group">
                    <label>üìÑ –û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea id="workDescription" required placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã..."></textarea>
                </div>

                <div class="form-group">
                    <label>üè∑Ô∏è –•—ç—à—Ç–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                    <input type="text" id="workHashtags" placeholder="#–∫–æ–º–ø–ª–µ–∫—Å, #–ø—Ä–µ–º–∏—É–º, #–∫–æ—à–∫–∏" class="hashtags-input">
                    <small style="color: var(--text-light);">–•—ç—à—Ç–µ–≥–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤</small>
                </div>

                <div class="form-group">
                    <label>üìè –†–∞–∑–º–µ—Ä—ã:</label>
                    <input type="text" id="workDimensions" placeholder="180√ó80√ó60 —Å–º">
                </div>

                <div class="form-group">
                    <label>üî® –ú–∞—Ç–µ—Ä–∏–∞–ª—ã:</label>
                    <input type="text" id="workMaterials" placeholder="–ë–µ—Ä–µ–∑–æ–≤–∞—è —Ñ–∞–Ω–µ—Ä–∞, –¥–∂—É—Ç">
                </div>

                <div class="form-group">
                    <label>üí∞ –¶–µ–Ω–∞:</label>
                    <input type="text" id="workPrice" placeholder="15 000 - 25 000 ‚ÇΩ">
                </div>

                <div style="text-align: center; margin-top: 25px;">
                    <button type="submit" class="btn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addModal')">‚ùå –û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram?.WebApp;
        let isAdmin = false;

        if (tg) {
            tg.ready();
            tg.expand();
            tg.enableClosingConfirmation();

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞ —á–µ—Ä–µ–∑ initData
            const initData = tg.initData;
            if (initData) {
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞–¥–º–∏–Ω—Å–∫–∏—Ö –ø—Ä–∞–≤
                // isAdmin = checkAdminRights(initData);
                isAdmin = true; // –î–ª—è –¥–µ–º–æ - –≤–∫–ª—é—á–∞–µ–º –∞–¥–º–∏–Ω —Ä–µ–∂–∏–º
            }
        }

        // –î–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç (–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ localStorage –∏–ª–∏ API)
        let works = JSON.parse(localStorage.getItem('galleryWorks')) || [
            {
                id: 1,
                title: "–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å '–¶–∞—Ä—Å–∫–∏–π –¥–≤–æ—Ä–µ—Ü'",
                description: "–†–æ—Å–∫–æ—à–Ω—ã–π 5-—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –∫–æ—à–µ–∫ —Å –∫–æ–≥—Ç–µ—Ç–æ—á–∫–∞–º–∏, –¥–æ–º–∏–∫–∞–º–∏ –∏ –ª–µ–∂–∞–Ω–∫–∞–º–∏ –∏–∑ premium –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤",
                image: "https://images.unsplash.com/photo-1545008344-4c1b3c5a5a53?w=400&h=300&fit=crop",
                hashtags: ["#–∫–æ–º–ø–ª–µ–∫—Å", "#–ø—Ä–µ–º–∏—É–º", "#–∫—Ä—É–ø–Ω—ã–µ–∫–æ—à–∫–∏", "#5—É—Ä–æ–≤–Ω–µ–π"],
                dimensions: "180√ó80√ó60 —Å–º",
                materials: "–ë–µ—Ä–µ–∑–æ–≤–∞—è —Ñ–∞–Ω–µ—Ä–∞, –¥–∂—É—Ç, –ø–ª—é—à",
                price: "15 000 - 25 000 ‚ÇΩ",
                views: 145
            },
            {
                id: 2,
                title: "–ù–∞—Å—Ç–µ–Ω–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å '–î–∂—É–Ω–≥–ª–∏'",
                description: "–ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–æ–∫ –∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ—à–µ–∫. –ö—Ä–µ–ø–∏—Ç—Å—è –∫ —Å—Ç–µ–Ω–µ, —ç–∫–æ–Ω–æ–º–∏—Ç –º–µ—Å—Ç–æ –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ",
                image: "https://images.unsplash.com/photo-1574144611937-0df059b5ef3e?w=400&h=300&fit=crop",
                hashtags: ["#–Ω–∞—Å—Ç–µ–Ω–Ω—ã–π", "#–º–æ–¥—É–ª—å–Ω—ã–π", "#–∞–∫—Ç–∏–≤–Ω—ã–µ", "#–∫–æ—à–∫–∏"],
                dimensions: "200√ó40√ó160 —Å–º",
                materials: "–ú–∞—Å—Å–∏–≤ —Å–æ—Å–Ω—ã, —Å–∏–∑–∞–ª—å",
                price: "8 000 - 12 000 ‚ÇΩ",
                views: 98
            },
            {
                id: 3,
                title: "–õ–µ—Å–µ–Ω–∫–∞ '–ö–æ–º—Ñ–æ—Ä—Ç'",
                description: "–î–µ—Ä–µ–≤—è–Ω–Ω–∞—è –ª–µ—Å–µ–Ω–∫–∞ —Å –∞–Ω—Ç–∏—Å–∫–æ–ª—å–∑—è—â–∏–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º –¥–ª—è –ø–æ–∂–∏–ª—ã—Ö –∏ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–æ–±–∞–∫. –†–µ–≥—É–ª–∏—Ä—É–µ–º–∞—è –≤—ã—Å–æ—Ç–∞",
                image: "https://images.unsplash.com/photo-1601758228041-f3b2795255f1?w=400&h=300&fit=crop",
                hashtags: ["#–ª–µ—Å–µ–Ω–∫–∞", "#—Å–æ–±–∞–∫–∏", "#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "#–ø–æ–∂–∏–ª—ã–µ"],
                dimensions: "60√ó35√ó40 —Å–º",
                materials: "–ú–∞—Å—Å–∏–≤ –¥—É–±–∞, —Ä–µ–∑–∏–Ω–∞",
                price: "3 000 - 5 000 ‚ÇΩ",
                views: 67
            },
            {
                id: 4,
                title: "–î–æ–º–∏–∫-–±–µ—Ä–ª–æ–≥–∞ '–£—é—Ç–Ω—ã–π'",
                description: "–ó–∞–∫—Ä—ã—Ç—ã–π –¥–æ–º–∏–∫-—É–∫—Ä—ã—Ç–∏–µ –¥–ª—è –ø—É–≥–ª–∏–≤—ã—Ö –∫–æ—à–µ–∫ —Å –º—è–≥–∫–æ–π –ø–æ–¥—É—à–∫–æ–π –∏ —Ç–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏–µ–π",
                image: "https://images.unsplash.com/photo-1548247416-ec66f4900b2e?w=400&h=300&fit=crop",
                hashtags: ["#–¥–æ–º–∏–∫", "#—É–∫—Ä—ã—Ç–∏–µ", "#—É—é—Ç", "#–∫–æ—à–∫–∏"],
                dimensions: "45√ó45√ó35 —Å–º",
                materials: "–§–∞–Ω–µ—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –º–µ—Ö",
                price: "2 500 - 4 000 ‚ÇΩ",
                views: 123
            }
        ];

        let currentFilter = 'all';
        let currentWorks = works;
        let allHashtags = new Set();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã
            document.getElementById('addWorkForm').addEventListener('submit', handleAddWork);
        });

        function initializeApp() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –µ—Å–ª–∏ –∞–¥–º–∏–Ω
            if (isAdmin) {
                document.getElementById('adminHeader').style.display = 'block';
                document.getElementById('adminControls').style.display = 'block';
            }

            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ö—ç—à—Ç–µ–≥–∏ –∏ —Å–æ–∑–¥–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
            updateHashtags();
            createFilters();

            // –°–∏–º—É–ª–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                renderGallery(works);
            }, 800);
        }

        function updateHashtags() {
            allHashtags.clear();
            works.forEach(work => {
                work.hashtags.forEach(tag => {
                    allHashtags.add(tag.replace('#', ''));
                });
            });
        }

        function createFilters() {
            const filtersContainer = document.getElementById('filters');
            const allBtn = filtersContainer.querySelector('[data-filter="all"]');

            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã, –∫—Ä–æ–º–µ "–í—Å–µ —Ä–∞–±–æ—Ç—ã"
            const oldFilters = filtersContainer.querySelectorAll('.filter-btn:not([data-filter="all"])');
            oldFilters.forEach(btn => btn.remove());

            // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Ö—ç—à—Ç–µ–≥–∞–º
            allHashtags.forEach(hashtag => {
                const filterBtn = document.createElement('div');
                filterBtn.className = 'filter-btn';
                filterBtn.setAttribute('data-filter', hashtag);

                // –≠–º–æ–¥–∑–∏ –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
                const emoji = getEmojiForHashtag(hashtag);
                filterBtn.innerHTML = `${emoji} ${hashtag}`;

                filterBtn.addEventListener('click', () => filterWorks(hashtag));
                filtersContainer.appendChild(filterBtn);
            });
        }

        function getEmojiForHashtag(hashtag) {
            const emojiMap = {
                '–∫–æ—à–∫–∏': 'üê±',
                '—Å–æ–±–∞–∫–∏': 'üêï',
                '–ø—Ä–µ–º–∏—É–º': '‚≠ê',
                '–∫–æ–º–ø–ª–µ–∫—Å': 'üè∞',
                '–¥–æ–º–∏–∫': 'üè†',
                '–ª–µ—Å–µ–Ω–∫–∞': 'ü™ú',
                '–Ω–∞—Å—Ç–µ–Ω–Ω—ã–π': 'üìê',
                '–º–æ–¥—É–ª—å–Ω—ã–π': 'üß©',
                '—É—é—Ç': 'ü§ó',
                '–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å': 'üõ°Ô∏è',
                '–∞–∫—Ç–∏–≤–Ω—ã–µ': '‚ö°',
                '–ø–æ–∂–∏–ª—ã–µ': 'üë¥'
            };
            return emojiMap[hashtag] || 'üè∑Ô∏è';
        }

        function renderGallery(worksToShow) {
            const gallery = document.getElementById('gallery');
            const empty = document.getElementById('empty');

            if (!worksToShow.length) {
                gallery.style.display = 'none';
                empty.style.display = 'block';
                return;
            }

            empty.style.display = 'none';
            gallery.style.display = 'grid';
            gallery.innerHTML = '';

            worksToShow.forEach(work => {
                const card = createWorkCard(work);
                gallery.appendChild(card);
            });
        }

        function createWorkCard(work) {
            const card = document.createElement('div');
            card.className = 'work-card';
            card.onclick = () => openViewModal(work);

            card.innerHTML = `
                ${isAdmin ? `<button class="delete-btn" onclick="deleteWork(event, ${work.id})" style="display: flex;">√ó</button>` : ''}
                <img src="${work.image}" alt="${work.title}" class="work-image" loading="lazy">
                <div class="work-info">
                    <h3 class="work-title">${work.title}</h3>
                    <p class="work-description">${work.description}</p>
                    <div class="work-meta">
                        <span>üìè ${work.dimensions || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</span>
                        <span>üî® ${work.materials?.split(',')[0] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</span>
                    </div>
                    <div class="work-tags">
                        ${work.hashtags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                    <div class="work-stats">
                        <div class="price">${work.price || '–ü–æ –∑–∞–ø—Ä–æ—Å—É'}</div>
                        <div class="views">üëÄ ${work.views || 0}</div>
                    </div>
                </div>
            `;

            return card;
        }

        function filterWorks(filter) {
            currentFilter = filter;

            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');

            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ä–∞–±–æ—Ç—ã
            if (filter === 'all') {
                currentWorks = works;
            } else {
                currentWorks = works.filter(work =>
                    work.hashtags.some(tag => tag.replace('#', '') === filter)
                );
            }

            renderGallery(currentWorks);

            // Haptic feedback
            if (tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        function openViewModal(work) {
            const modal = document.getElementById('viewModal');
            const modalImage = document.getElementById('modalImage');
            const modalTitle = document.getElementById('modalTitle');
            const modalDescription = document.getElementById('modalDescription');
            const modalTags = document.getElementById('modalTags');
            const modalSpecs = document.getElementById('modalSpecs');

            modalImage.src = work.image;
            modalImage.alt = work.title;
            modalTitle.textContent = work.title;
            modalDescription.textContent = work.description;
            modalTags.innerHTML = work.hashtags.map(tag => `<span class="tag">${tag}</span>`).join('');
            modalSpecs.innerHTML = `
                <p style="margin: 10px 0;"><strong>üìè –†–∞–∑–º–µ—Ä—ã:</strong> ${work.dimensions || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                <p style="margin: 10px 0;"><strong>üî® –ú–∞—Ç–µ—Ä–∏–∞–ª—ã:</strong> ${work.materials || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                <p style="margin: 10px 0;"><strong>üí∞ –¶–µ–Ω–∞:</strong> ${work.price || '–ü–æ –∑–∞–ø—Ä–æ—Å—É'}</p>
                <p style="margin: 10px 0;"><strong>üëÄ –ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤:</strong> ${work.views || 0}</p>
            `;

            modal.style.display = 'block';

            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
            work.views = (work.views || 0) + 1;
            saveWorks();

            // Haptic feedback
            if (tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('medium');
            }
        }

        function openAddWorkModal() {
            document.getElementById('addModal').style.display = 'block';

            if (tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';

            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
            if (modalId === 'addModal') {
                document.getElementById('addWorkForm').reset();
            }
        }

        function handleAddWork(e) {
            e.preventDefault();

            if (!isAdmin) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç!');
                return;
            }

            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
            const formData = {
                id: Date.now(), // –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID
                title: document.getElementById('workTitle').value.trim(),
                description: document.getElementById('workDescription').value.trim(),
                image: document.getElementById('imageUrl').value.trim(),
                hashtags: document.getElementById('workHashtags').value
                    .split(',')
                    .map(tag => tag.trim())
                    .filter(tag => tag)
                    .map(tag => tag.startsWith('#') ? tag : '#' + tag),
                dimensions: document.getElementById('workDimensions').value.trim(),
                materials: document.getElementById('workMaterials').value.trim(),
                price: document.getElementById('workPrice').value.trim(),
                views: 0
            };

            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!formData.title || !formData.description || !formData.image) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ!');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            if (!isValidUrl(formData.image)) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è!');
                return;
            }

            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–±–æ—Ç—É
            works.push(formData);
            saveWorks();

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateHashtags();
            createFilters();

            // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π —Ñ–∏–ª—å—Ç—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–≤–æ–π —Ä–∞–±–æ—Ç–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—ë
            if (currentFilter === 'all' ||
                formData.hashtags.some(tag => tag.replace('#', '') === currentFilter)) {
                filterWorks(currentFilter);
            }

            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeModal('addModal');

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('‚úÖ –†–∞–±–æ—Ç–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');

            // Haptic feedback
            if (tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('heavy');
            }
        }

        function deleteWork(event, workId) {
            event.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞

            if (!isAdmin) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç!');
                return;
            }

            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ä–∞–±–æ—Ç—É?')) {
                // –ù–∞—Ö–æ–¥–∏–º –∏ —É–¥–∞–ª—è–µ–º —Ä–∞–±–æ—Ç—É
                const workIndex = works.findIndex(work => work.id === workId);
                if (workIndex > -1) {
                    const deletedWork = works[workIndex];
                    works.splice(workIndex, 1);
                    saveWorks();

                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    updateHashtags();
                    createFilters();
                    filterWorks(currentFilter);

                    showNotification(`üóëÔ∏è –†–∞–±–æ—Ç–∞ "${deletedWork.title}" —É–¥–∞–ª–µ–Ω–∞`, 'success');

                    if (tg?.HapticFeedback) {
                        tg.HapticFeedback.impactOccurred('heavy');
                    }
                }
            }
        }

        function orderWork() {
            if (tg?.sendData) {
                tg.sendData(JSON.stringify({
                    action: 'order_work',
                    message: '–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å –∏–∑–¥–µ–ª–∏–µ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏'
                }));
            }

            if (tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('heavy');
            }

            closeModal('viewModal');
            showNotification('üìû –í–∞—à –∑–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.', 'success');
        }

        function saveWorks() {
            try {
                localStorage.setItem('galleryWorks', JSON.stringify(works));
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
                showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö', 'error');
            }
        }

        function isValidUrl(string) {
            try {
                const url = new URL(string);
                return url.protocol === 'http:' || url.protocol === 'https:';
            } catch (_) {
                return false;
            }
        }

        function showNotification(message, type = 'info') {
            // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'var(--primary-blue)' : type === 'error' ? '#ff4757' : 'var(--primary-pink)'};
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                z-index: 2000;
                font-weight: 500;
                max-width: 300px;
                animation: slideIn 0.3s ease;
                backdrop-filter: blur(10px);
            `;

            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);

            notification.textContent = message;
            document.body.appendChild(notification);

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal('viewModal');
                closeModal('addModal');
            }
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        ['viewModal', 'addModal'].forEach(modalId => {
            document.getElementById(modalId).onclick = (e) => {
                if (e.target === document.getElementById(modalId)) {
                    closeModal(modalId);
                }
            };
        });

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º—ã –ø–æ–¥ Telegram
        if (tg?.colorScheme === 'dark') {
            document.documentElement.style.setProperty('--gradient', 'linear-gradient(135deg, #2c3e50 0%, #34495e 100%)');
            document.documentElement.style.setProperty('--text-dark', '#e0e0e0');
            document.documentElement.style.setProperty('--text-light', '#b0b0b0');
        }

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∞–¥–º–∏–Ω–∞
        if (isAdmin) {
            // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'n':
                            e.preventDefault();
                            openAddWorkModal();
                            break;
                        case 's':
                            e.preventDefault();
                            saveWorks();
                            showNotification('üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
                            break;
                    }
                }
            });

            // –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–¥–º–∏–Ω–∞
            window.exportWorks = function() {
                const dataStr = JSON.stringify(works, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'gallery-works.json';
                link.click();
                showNotification('üì§ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
            };

            window.importWorks = function(input) {
                const file = input.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedWorks = JSON.parse(e.target.result);
                            if (confirm(`–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å ${importedWorks.length} —Ä–∞–±–æ—Ç? –¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–º–µ–Ω–µ–Ω—ã.`)) {
                                works = importedWorks;
                                saveWorks();
                                updateHashtags();
                                createFilters();
                                filterWorks('all');
                                showNotification('üì• –î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
                            }
                        } catch (err) {
                            showNotification('‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };

            console.log('üîß –ê–¥–º–∏–Ω-—Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω. –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:');
            console.log('- Ctrl+N: –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É');
            console.log('- Ctrl+S: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ');
            console.log('- exportWorks(): —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö');
            console.log('- importWorks(input): –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö');
        }
    </script>
</body>
</html>
